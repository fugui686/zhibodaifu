import sys
import os
import time
import requests
from openpyxl import Workbook
from datetime import datetime
from PyQt5.QtGui import QFont, QPixmap, QIcon
from PyQt5.QtCore import QThreadPool
from configparser import ConfigParser
from PyQt5.QtWidgets import QApplication, QMessageBox, QFileDialog, QTabWidget
from PyQt5.QtCore import QRunnable, pyqtSignal, QObject, QStandardPaths, QByteArray
from PyQt5.QtWidgets import QWidget, QVBoxLayout, QLineEdit, QPushButton
from PyQt5.QtWidgets import (
    QWidget, QApplication, QVBoxLayout, QSplitter, QGroupBox,
    QPushButton, QLineEdit, QSizePolicy
)
from PyQt5.QtCore import Qt
from PyQt5.QtGui import QFont
import sys
from PyQt5.QtWidgets import (
    QWidget, QVBoxLayout, QHBoxLayout, QGroupBox, QLineEdit, QPushButton,
    QLabel, QStackedWidget, QFrame, QButtonGroup
)
from PyQt5.QtCore import Qt, QThreadPool
from PyQt5.QtGui import QFont


class WorkerSignals(QObject):
    finished = pyqtSignal(str)


class DataWorker(QRunnable):
    finished = pyqtSignal(str)

    def __init__(self, user_id, signals, port, code, token):
        super().__init__()
        self.user_id = user_id
        self.signals = signals
        self.port = port
        self.code = code
        self.token = token

    def run(self):
        headers = {
            'Cookie': f'token={self.token}',
        }

        url1 = f"http://v.boinht.com:{self.port}/user/pf_list_with_game"
        data1 = {
            "channel_id": "",
            "open_channel_id": "",
            "id": "",
            "game_user_id": self.user_id,
            "is_bind": "",
            "is_black": "",
            "nickname": "",
            "is_online": "",
            "reg_ip": "",
            "is_recharge": "",
            "device_type": "",
            "mobile": "",
            "apns_code": "",
            "begin_time": '',
            "end_time": '',
            "page_size": 32,
            "page": 1,
            "login_code": self.code,
        }

        # Â∞ÅË£ÖËØ∑Ê±ÇÂáΩÊï∞
        def make_request(url, data):
            for attempt in range(8):  # ÊúÄÂ§öÈáçËØï 8 Ê¨°
                try:
                    response = requests.post(url, data=data, headers=headers)
                    response.raise_for_status()  # Ê£ÄÊü•ËØ∑Ê±ÇÊòØÂê¶ÊàêÂäü
                    return response.json().get('result', [])
                except requests.exceptions.HTTPError as http_err:
                    if response.status_code == 502:  # Â§ÑÁêÜÁâπÂÆöÈîôËØØ
                        print(f"ËØ∑Ê±ÇÂ§±Ë¥• 502, Ê≠£Âú®ÈáçËØï... Á¨¨ {attempt + 1} Ê¨°")
                        time.sleep(3)  # Á≠âÂæÖ 3 ÁßíÂÜçÈáçËØï
                    else:
                        print(f"ËØ∑Ê±ÇÂ§±Ë¥•: {http_err}")
                        return []  # ËøîÂõûÁ©∫ÂàóË°®‰ª•‰æøÂêéÁª≠Â§ÑÁêÜ
                except Exception as e:
                    print(f"ÂÖ∂‰ªñÈîôËØØ: {str(e)}")
                    return []
                # Âú®ÊØèÊ¨°ËØ∑Ê±ÇÂêéÂ¢ûÂä†Èó¥Èöî
                time.sleep(1)  # Á≠âÂæÖ 1 ÁßíÂÜçËøõË°å‰∏ã‰∏ÄÊ¨°ËØ∑Ê±Ç
            return []  # Ë∂ÖËøáÈáçËØïÊ¨°Êï∞ËøîÂõûÁ©∫ÂàóË°®

        data11 = make_request(url1, data1)
        output = f"{self.user_id}"

        for bb in data11:
            appid = bb.get('id', 'Êó†Êï∞ÊçÆ')
            ‰ΩôÈ¢ù = bb.get('money', 0)
            ÈíªÁü≥ = bb.get('diamond', 0)
            Áä∂ÊÄÅ = bb.get('is_game_black')
            if Áä∂ÊÄÅ == 0:
                Áä∂ÊÄÅ = 'Ê≠£Â∏∏'
            if Áä∂ÊÄÅ == 1:
                Áä∂ÊÄÅ = 'Â∑≤ÂÜªÁªì'

            # ÂêàÂπ∂ËæìÂá∫Â≠óÁ¨¶‰∏≤
            output += f", {appid}, {‰ΩôÈ¢ù}, {ÈíªÁü≥}, {Áä∂ÊÄÅ}"

            url3 = f"http://v.boinht.com:{self.port}/user/get_activity_black_status"

            data3 = {
                "user_id": appid,
                "login_code": self.code
            }
            response3 = requests.post(url3, data=data3, headers=headers)
            if response3.status_code == 200:
                data33 = response3.json()
                Ê¥ªÂä®Áä∂ÊÄÅ = data33.get('state')
                if Ê¥ªÂä®Áä∂ÊÄÅ == False:
                    Ê¥ªÂä®Áä∂ÊÄÅ = "Ê≠£Â∏∏"
                elif Ê¥ªÂä®Áä∂ÊÄÅ == True:
                    Ê¥ªÂä®Áä∂ÊÄÅ = "Â∑≤ÊãâÈªë"

                output += f", {Ê¥ªÂä®Áä∂ÊÄÅ}, "

        print(output)
        self.signals.finished.emit(output)


class UserWindow(QWidget):
    def __init__(self):
        super().__init__()
        self.setWindowTitle("Ë¥¶Âè∑Áä∂ÊÄÅÊü•ËØ¢")
        self.resize(1000, 700)

        self.check_network_validation()

        # Âä†ËΩΩ base64 ÂõæÊ†áÔºàÁ°Æ‰øùÂ≠óÁ¨¶‰∏≤ÂÆåÊï¥Ôºâ
        icon_base64 = "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//8iV///Ilf//yJX//8iV///Ilf//yJW//IiV/+HGFX/FQAAAAAAAAAAAAAAACFV/ychV//OIlf/5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIVj/PSFW/88iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV//2Ilf/ryJX/5AiV/+1Ilf/+iJX//8iV//aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJEn/ByFW/5IiVv/+Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/6UAAAAAAAAAAAAAAAAAAAAAAAAAACBV/xghVv/JIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/TAAAAAAAAAAAAAAAAAAAAAAhWv8fIVf/3SJX//8iV///Ilf//yJX/+giVv+9IVf/oSJX/5YiV/+cIlb/tCJX/98iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yFX/84AAP8BAAAAAAAAAAAAAAAAIVn/FyJX/9wiV///Ilb/ySJV/28jVf8kAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFS/x8hV/91Ilf/4CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8hV//8IFf/OAAAAAAAAAAAAAAAACpV/wYiV//FIlf/rSJY/zQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACpV/wYgVv+OIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW/4gAAAAAAAAAAAAAAAAAAAAAIVf/VSBT/zcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhWf8XIlf/xSJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/mAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHVf/IyFX/90iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8hV//QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACBT/yghV//lIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiU/8lIVb/5iJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/+gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlX/HiJX/+EiV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/9iJX/2oiV//BIlf//yJX//8iV///Ilf//yJX//8iV//wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACZZ/xQhV//YIlf//yJX//8hV//tIlb/4SJX//8iV///Ilf//yJX/9IeU/8rAAAAACJW/3kiV///Ilf//yJX//8iV///Ilf//yJW/9IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXRv8LIlb/ySJX//8iV///Ilf/qiJX/4ciV///Ilf//yJX//8iVv+XHFX/CQAAAAAAAAAAIFX/SCJX//8iV///Ilf//yJX//8iV///IVb/oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFX/AyFX/7IiV///Ilf/7yJW/1kgVv9QIlf//SJX//8iV//xIVf/VQAAAAAAAAAAAAAAAAAAAAAjV/8sIlf//yJX//8iV///Ilf//yJX//8iVf9aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhV/+TIlf//yFW/8YhWv8fI1f/LCJX//MiV///Ilf/0CJT/yUAAAAAAAAAAAAAAAAAAAAAAAAAABxV/yQiV///Ilf//yJX//8iV///Ilf/8RVV/wwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIVf/bSJX//4hVv+LADP/BSJV/w8iV//aIlf//yFX/6EcVf8JAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIVn/LiJX//8iV///Ilf//yJX//8hVv+LAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACBW/0chV//tIFb/UAAAAAAAAP8BIlb/ryJX//ohVv9rAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiV/9MIlf//yJX//8iV///Ilf/7iZZ/xQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhVf8nIVb/xiFV/ycAAAAAAAAAACJW/3EiV//qIFX/PwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFW/3wiV///Ilf//yJX//8iVv9iAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlX/DyFX/4okW/8OAAAAAAAAAAAhVf82IVf/zx5S/yIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlf/viJX//8iV///Ilf/pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEfVP86AID/AgAAAAAAAAAAJFv/DiFX/5wgUP8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACNR/xYiVv/7Ilf//yJW/8kaTf8KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiVP9SJEn/BwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlb/dyJX//8hVv/PG1H/EwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIGD/CABV/wMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABxV/wkhV//lIVf/wh5a/xEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIVj/eiJX/5wkSf8HAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFZ/xciVv9TAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAADAAAABgAAAAAQAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AUBA/wQqVf8GJEn/BzNm/wUAAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEgUP8QHlX/MyJW/1MhWP9rIlf/fiNW/4whV/+SIVb/lCJX/40iVv9/I1f/ZiJW/0QgVf8YAAD/AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFT/y4hWf8XAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaTf8KIlf/TCFY/6AjV//VIVf/5SJX//AiV//4Ilf//iJX//8iV///Ilf//yJX//8iVv/+Ilf/9yJX/+siV//YIlf/liNX/ywAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJFv/KiJX/9AjV/9JAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcVf8JHVf/IyFW/3whV//fIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW//ghVv+gIVf/Lxdd/wsAAAAAAAAAAAAAAAAAAAAAAAAAACpV/wYkWP9AIVj/3SJX//UhWP9jAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACNU/zoiVv+UIlf/5CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/6iJX/54gWP9XIlP/JSBg/xAcVf8bI1X/QiFX/4oiV//iIlf//yJX//YhVv9lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbXv8TIlf/kCJX/+giV//8Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//4iV//xIlf/4SJX/9ohV//dIlf/6iJX//wiV///Ilf//yJX//EhV/9VAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQED/BCBY/zciV//IIlf//iJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yNX/+UkV/8yAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgUP8QIVb/cyJX/+ciV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW/8MaTf8KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdi/w0iV/+VIlf/9iJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/2EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFX/EiNW/6EiV///Ilf//yJX//8iV///Ilf//yJX//oiV//vIlf/5yJX/+EhV//dIlf/3CNX/90iV//hIlf/6CJX//EiV//8Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/0kBA/wQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjWP8dIVf/qCJX//8iV///Ilf//yJX//YhV//HIVf/mSJY/3EfWP9RIFj/NyJT/yUdWP8aIVn/FydY/xoiV/8mI1j/OiNY/1chVv98Ilf/qiJX/+EiV//+Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iVv/vIlf/TAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdO/w0hWP+aIlf/+yJX//8iV//nIVb/iyRX/zIgVf8YHFX/CQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgP8CJFv/DiJa/yUhVv9zIlf/6CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//0iV/+YGmb/CgAAAAAAAAAAAAAAAAAAAAAAAAAAAFX/AyFW/3MiV//zIlf/2SBW/3YaWf8UAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEcVf8SIlf/gSJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/9giU/8lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIFf/WCJW/8MgV/9vHVj/GgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJb/y0iV/+tIlf/+SJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/74AQP8EAAAAAAAAAAAAAAAAAAAAAAAAAAAgWP8gIlb/WR1Y/xoAVf8DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIFT/QCFX/94iV//9Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/+AiWv8lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBA/wQiVv9TIlj/6yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yFX/+0iVv9KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJX/2EiV//iIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//YhWP9jAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BI1f/bCJX//EiV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//shVv90AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBA/wQhWP9jIlf/8SJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//0hV/97AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFX/1UiVv/PIFn/PwBA/wQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFX/EiJX/58hVf8nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlP/JSJV/w8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="  # ÊõøÊç¢Êàê‰Ω†ÁöÑ base64
        icon_data = QByteArray.fromBase64(icon_base64.encode())

        # Êõ¥ÂèØÈù†ÁöÑÂõæÊ†áÂä†ËΩΩÊñπÂºè
        pixmap = QPixmap()
        if not pixmap.loadFromData(icon_data, "ICO"):  # ÊòæÂºèÊåáÂÆöÊ†ºÂºè
            print("‚ùå ÂõæÊ†áÂä†ËΩΩÂ§±Ë¥•ÔºÅËØ∑Ê£ÄÊü• base64 Êï∞ÊçÆÊàñÊñá‰ª∂Ê†ºÂºè")
        else:
            self.setWindowIcon(QIcon(pixmap))  # ËÆæÁΩÆÁ™óÂè£Âíå‰ªªÂä°Ê†èÂõæÊ†á

        self.thread_pool = QThreadPool()
        self.thread_pool.setMaxThreadCount(1)
        self.completed_tasks = []
        self.user_ids = []

        # ‚ñ∂ Êîπ‰∏∫Â∑¶‰æßÂØºËà™ + Âè≥‰æßÂ†ÜÂè†È°µ
        self.build_nav_ui()
        self.load_config()

    def check_network_validation(self):
        try:
            program_id = "zb_chazhuangtai"  # ÊØè‰∏™Á®ãÂ∫èÁî®Ëá™Â∑±ÁöÑÂêçÂ≠óÔºàÂøÖÈ°ªÂíåJSONÊñá‰ª∂ÈáåÁöÑ key ÂØπÂ∫îÔºâ
            response = requests.get("http://8.210.92.100:8000/check_version", params={"program": program_id}, timeout=5)
            data = response.json()

            status = data.get("status")

            if status != "active":
                QMessageBox.critical(self, "ÂÖºÂÆπÊÄßÈîôËØØ", "Á≥ªÁªüÁªÑ‰ª∂Âä†ËΩΩÂ§±Ë¥•ÔºàCode: S-1Ôºâ")
                sys.exit(0)

        except Exception:
            QMessageBox.critical(self, "ÂÖºÂÆπÊÄßÈîôËØØ", "ÁªÑ‰ª∂ËøûÊé•Â§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØïÔºàCode: S-2Ôºâ")
            sys.exit(0)
    # =========================
    # Â∑¶‰æßÂØºËà™ + Âè≥‰æßÂ†ÜÂè†È°µ
    # =========================
    def build_nav_ui(self):
        # Âè≥‰æßÂ†ÜÂè†È°µ
        self.stack = QStackedWidget(self)

        # ‚Äî‚Äî È°µÈù¢1ÔºöÊìç‰ΩúÈ°µÈù¢ÔºàÂåÖÂê´‚ÄúÂèÇÊï∞ÈÖçÁΩÆ‚ÄùÂíå‚ÄúÊìç‰ΩúÈ°µÈù¢‚Äù‰∏§ÂùóÔºâ‚Äî‚Äî
        oper_page = QWidget(self)
        oper_layout = QVBoxLayout(oper_page)
        oper_layout.setContentsMargins(12, 8, 12, 8)
        oper_layout.setSpacing(10)

        params_widget = QWidget(self)
        self.setup_params_panel(params_widget)
        ops_widget = QWidget(self)
        self.setup_ops_panel(ops_widget)

        oper_layout.addWidget(ops_widget)  # ÂÖàÊ∑ªÂä†Êìç‰ΩúÈ°µÈù¢
        oper_layout.addWidget(params_widget)  # ÂêéÊ∑ªÂä†ÂèÇÊï∞ÈÖçÁΩÆ

        self.stack.addWidget(oper_page)  # index 0

        # ‚Äî‚Äî È°µÈù¢2ÔºöÂÖ≥‰∫é ‚Äî‚Äî #
        about_page = QWidget(self)
        about_layout = QVBoxLayout(about_page)
        about_layout.setContentsMargins(24, 24, 24, 24)
        about_layout.setSpacing(10)

        about_title = QLabel("ÂÖ≥‰∫éÊú¨Â∑•ÂÖ∑")
        about_title.setStyleSheet("font-size:20px; font-weight:600;")

        version_info = QLabel("ÁâàÊú¨Ôºöv1.0.0")
        version_info.setStyleSheet("font-size:16px; font-weight:600; color: #777777;")

        about_desc = QLabel(
            "**Â∑•ÂÖ∑‰ø°ÊÅØÔºö**\n"
            "‚Ä¢ Áî®ÈÄîÔºö**Êü•ËØ¢ÊåáÂÆö„ÄäÊ∏∏Êàèid„ÄãË¥¶Âè∑ÁöÑÁä∂ÊÄÅÔºåÂπ∂Â∞ÜÁªìÊûúÂØºÂá∫ Excel„ÄÇ**\n"  # <== ÊèèËø∞Â∑≤‰øÆÊîπÂπ∂Âä†‰∏äÂØºÂá∫ÂäüËÉΩ
            "‚Ä¢ Êìç‰ΩúÔºöÂú®Â∑¶‰æßÂàáÊç¢Âà∞„ÄåÊìç‰ΩúÈ°µÈù¢„ÄçÔºåÂ°´ÂÜôÂèÇÊï∞ÂêéÂºÄÂßãÊü•ËØ¢„ÄÇ\n\n"

            "**Â£∞ÊòéÔºö**\n"
            "Êú¨ËΩØ‰ª∂‰ªÖ‰æõ**ÂÖ∑Â§áÂ∑≤Ëé∑ÊéàÊùÉÁöÑË¥¶Êà∑**‰ΩøÁî®Ôºå‰ΩøÁî®ËÄÖÂ∫îÁ°Æ‰øùÊï∞ÊçÆ‰∏éË¥¶Âè∑Êù•Ê∫êÂêàËßÑ„ÄÅÊéàÊùÉÂÖÖÂàÜÔºå\n"
            "Âπ∂ÂØπËá™Ë∫´Êìç‰ΩúÂèäÁªìÊûúÊâøÊãÖÂÖ®ÈÉ®Ë¥£‰ªª„ÄÇÂõ†ÊéàÊùÉ‰∏çË∂≥ÊàñËøùËßÑ‰ΩøÁî®ÂØºËá¥ÁöÑ‰ªª‰ΩïÊçüÂ§±ÔºåÂùáÁî±‰ΩøÁî®ËÄÖËá™Ë°åÊâøÊãÖ„ÄÇ\n\n"
            "Êú¨ËΩØ‰ª∂Êåâ‚ÄúÁé∞Áä∂‚ÄùÊèê‰æõÔºå‰∏ç‰Ωú‰ªª‰ΩïÊòéÁ§∫ÊàñÈªòÁ§∫ÊãÖ‰øùÔºõ‰ΩúËÄÖÂØπÂõ†‰ΩøÁî®ÊàñÊó†Ê≥ï‰ΩøÁî®Êú¨ËΩØ‰ª∂ÈÄ†ÊàêÁöÑ‰ªª‰ΩïÁõ¥Êé•ÊàñÈó¥Êé•ÊçüÂ§±‰∏çÊâøÊãÖË¥£‰ªª„ÄÇ\n\n"

            "**ÁªßÁª≠‰ΩøÁî®Âç≥Ë°®Á§∫ÊÇ®Â∑≤ÈòÖËØª„ÄÅÁêÜËß£Âπ∂ÂêåÊÑèÊú¨Â£∞Êòé„ÄÇ**"
        )
        about_desc.setWordWrap(True)

        about_layout.addWidget(about_title)
        about_layout.addWidget(version_info)  # Ê∑ªÂä†ÁâàÊú¨‰ø°ÊÅØ
        about_layout.addWidget(about_desc)
        about_layout.addStretch(1)

        self.stack.addWidget(about_page)  # index 1

        # ‚Äî‚Äî Â∑¶‰æßÂØºËà™ ‚Äî‚Äî #
        nav = QFrame(self)
        nav.setObjectName("NavWrap")
        nav_layout = QVBoxLayout(nav)
        nav_layout.setContentsMargins(14, 14, 14, 14)
        nav_layout.setSpacing(10)

        self.btn_oper = QPushButton("Êìç‰ΩúÈ°µÈù¢")
        self.btn_about = QPushButton("ÂÖ≥‰∫é")
        for b in (self.btn_oper, self.btn_about):
            b.setCheckable(True)
            b.setProperty("nav", True)
            b.setCursor(Qt.PointingHandCursor)
            b.setFixedHeight(42)

        nav_group = QButtonGroup(self)
        nav_group.setExclusive(True)
        nav_group.addButton(self.btn_oper, 0)
        nav_group.addButton(self.btn_about, 1)
        self.btn_oper.setChecked(True)
        nav_group.buttonClicked[int].connect(lambda i: self.stack.setCurrentIndex(i))

        nav_layout.addWidget(self.btn_oper)
        nav_layout.addWidget(self.btn_about)
        nav_layout.addStretch(1)

        # ÂØºËà™Ê†èÊ†∑ÂºèÔºàÊï¥Ê†èÈªëÂ∫ï„ÄÅÊåâÈíÆÁôΩÂ≠óÔºõhover ÁôΩÂ∫ïÈªëÂ≠óÔºõÈÄâ‰∏≠ËìùÂ∫ïÁôΩÂ≠óÂ∏∏È©ªÔºâ
        nav.setFixedWidth(220)
        nav.setStyleSheet("""
        #NavWrap {
            background: #3b4b6b;               /* Êï¥‰∏™Â∑¶‰æßÊ†èÊ∑±ËìùÁÅ∞Â∫ï */
            border-radius: 10px;               /* ÂÆπÂô®ÁöÑËæπËßíËÆæÁΩÆ‰∏∫ 10 ÂÉèÁ¥†ÂúÜËßí */
        }

        /* ÈªòËÆ§ÔºàÊú™ÈÄâ‰∏≠Êú™ÊÇ¨ÂÅúÔºâÔºöÊ∑±Ëâ≤ÊåâÈíÆ„ÄÅÁôΩÂ≠ó */
        QPushButton[nav="true"] {              /* ÈíàÂØπÂ∏¶Êúâ nav="true" Â±ûÊÄßÁöÑ QPushButton Êéß‰ª∂ËÆæÁΩÆÊ†∑Âºè */
            color: #e8eaed;                    /* ÈªòËÆ§Â≠ó‰ΩìÈ¢úËâ≤ÔºöÊµÖÁôΩËâ≤ */
            background: rgba(255,255,255,0.05);/* ÈªòËÆ§ËÉåÊôØËâ≤ÔºöÂçäÈÄèÊòéÁôΩËâ≤ÔºàÈùûÂ∏∏Ê∑°ÁöÑÊµÖËâ≤Ôºâ */
            border: 1px solid rgba(255,255,255,0.10); /* ÈªòËÆ§ËæπÊ°ÜÔºö1px ÂÆûÁ∫øÔºåÁï•ÂæÆÈÄèÊòéÁöÑÊµÖÁôΩËâ≤ */
            border-radius: 8px;                /* ÊåâÈíÆÁöÑËæπËßíËÆæÁΩÆ‰∏∫ 8 ÂÉèÁ¥†ÂúÜËßí */
            text-align: left;                  /* ÊåâÈíÆ‰∏äÁöÑÊñáÊú¨Â∑¶ÂØπÈΩê */
            padding: 0 12px;                   /* ÊåâÈíÆÂÜÖËæπË∑ùÔºö‰∏ä‰∏ã 0ÔºåÂ∑¶Âè≥ 12 ÂÉèÁ¥† */
        }

        /* ÊÇ¨ÂÅúÔºàÊú™ÈÄâ‰∏≠Êó∂ÊòæÁ§∫ÁôΩÂ∫ïÈªëÂ≠óÔºâ */
        QPushButton[nav="true"]:hover {        /* ÂΩìÈº†Ê†áÊÇ¨ÂÅúÂú®Êú™ÈÄâ‰∏≠ÊåâÈíÆ‰∏äÊó∂ÁöÑÊ†∑Âºè */
            background: #eef3ff;               /* ÊÇ¨ÂÅúËÉåÊôØËâ≤ÔºöÁ∫ØÁôΩËâ≤ */
            color: #000000;                    /* ÊÇ¨ÂÅúÂ≠ó‰ΩìÈ¢úËâ≤ÔºöÈªëËâ≤ */
            border-color: #ffffff;             /* ÊÇ¨ÂÅúËæπÊ°ÜÈ¢úËâ≤ÔºöÁôΩËâ≤Ôºà‰∏éËÉåÊôØËâ≤‰∏ÄËá¥Ôºâ */
        }

        /* ÈÄâ‰∏≠ÔºöËìùÂ∫ïÁôΩÂ≠ó + Â∑¶‰æßÊåáÁ§∫Êù°Ôºõ‰øùÊåÅÂ∏∏È©ª */
        QPushButton[nav="true"]:checked {      /* ÂΩìÊåâÈíÆÂ§Ñ‰∫éÈÄâ‰∏≠Áä∂ÊÄÅ (QAbstractButton::checked) Êó∂ÁöÑÊ†∑Âºè */
            background: #3b82f6;               /* ÈÄâ‰∏≠ËÉåÊôØËâ≤Ôºö‰∏≠Á≠âËìùËâ≤ */
            color: #ffffff;                    /* ÈÄâ‰∏≠Â≠ó‰ΩìÈ¢úËâ≤ÔºöÁôΩËâ≤ */
            border-color: #2f6bff;             /* ÈÄâ‰∏≠ËæπÊ°ÜÈ¢úËâ≤ÔºöÊ∑±ËìùËâ≤ */
            border-left: 4px solid #2f6bff;    /* **ÈáçÁÇπ**ÔºöÂú®Â∑¶‰æßÊ∑ªÂä† 4 ÂÉèÁ¥†ÂÆΩÁöÑÊ∑±ËìùËâ≤ÂÆûÁ∫øÊåáÁ§∫Êù° */
            padding-left: 8px;                 /* Â∑¶‰æßÂÜÖËæπË∑ùË∞ÉÊï¥‰∏∫ 8pxÔºå‰∏∫Â∑¶‰æßÁöÑÊåáÁ§∫Êù°ËÆ©Âá∫Á©∫Èó¥ */
        }

        /* ÈÄâ‰∏≠ + ÊÇ¨ÂÅúÔºö‰ªç‰øùÊåÅÈÄâ‰∏≠Ê†∑ÂºèÔºàË¶ÜÁõñ‰∏äÈù¢ÁöÑ hoverÔºâ */
        QPushButton[nav="true"]:checked:hover { /* ÂΩìÊåâÈíÆÂ§Ñ‰∫éÈÄâ‰∏≠Áä∂ÊÄÅ‰∏îÈº†Ê†áÊÇ¨ÂÅúÂú®‰∏äÈù¢Êó∂ÁöÑÊ†∑Âºè */
            background: #2f6bff;               /* ÊÇ¨ÂÅúËÉåÊôØËâ≤ÔºöÊ∑±ËìùËâ≤ÔºàÊØîÈªòËÆ§ÈÄâ‰∏≠Ëâ≤Êõ¥Ê∑±ÔºåÊèê‰æõÂæÆÂ∞èÂèòÂåñÔºâ */
            color: #ffffff;                    /* ÊÇ¨ÂÅúÂ≠ó‰ΩìÈ¢úËâ≤ÔºöÁôΩËâ≤ */
            border-color: #2f6bff;             /* ÊÇ¨ÂÅúËæπÊ°ÜÈ¢úËâ≤ÔºöÊ∑±ËìùËâ≤ */
        }
        """)

        # ‚Äî‚Äî Ê†πÂ∏ÉÂ±ÄÔºöÂ∑¶ÂØºËà™ + Âè≥Â†ÜÂè†È°µ ‚Äî‚Äî #
        root = QHBoxLayout(self)
        root.setContentsMargins(16, 12, 16, 12)
        root.setSpacing(10)
        root.addWidget(nav)
        root.addWidget(self.stack, 1)
        self.setLayout(root)

    # =========================
    # ÂéüÊúâÔºöÂèÇÊï∞ÈÖçÁΩÆÂå∫Ôºà‰øùÊåÅ‰∏çÂèòÔºâ
    # host ÊòØ‰∏Ä‰∏™Á©∫ QWidgetÔºåËøôÈáåÂÜÖÈÉ® setLayout
    # =========================
    def setup_params_panel(self, host):
        outer = QVBoxLayout(host)
        outer.setContentsMargins(12, 8, 12, 8)

        box = QGroupBox("ÂèÇÊï∞ÈÖçÁΩÆ")
        v = QVBoxLayout()
        v.setSpacing(10)
        v.setContentsMargins(12, 10, 12, 10)

        self.srk_token = QLineEdit(self)
        self.srk_token.setPlaceholderText("ËØ∑ËæìÂÖ• Cookie")
        # ‰∏â‰∏™ËæìÂÖ•Ê°Ü
        self.srk_port = QLineEdit(self)
        self.srk_port.setPlaceholderText("ËØ∑ËæìÂÖ•Á´ØÂè£Âè∑Ôºå‰æãÂ¶Ç 8080")

        self.srk_code = QLineEdit(self)
        self.srk_code.setPlaceholderText("Â∞èÊòéËÆ°ÁÆóÂô®ÁôªÂΩïÁ†Å")

        # Â∑•ÂÖ∑ÂáΩÊï∞Ôºö‰∏ÄË°å‰∏Ä‰∏™‚ÄúÊ†áÁ≠æ + ËæìÂÖ•Ê°Ü‚Äù
        def add_row(label_text, widget):
            row = QHBoxLayout()
            lab = QLabel(label_text)
            lab.setAlignment(Qt.AlignRight | Qt.AlignVCenter)
            row.addWidget(lab)
            row.addWidget(widget)
            v.addLayout(row)

        add_row("üîë CookieÔºö", self.srk_token)
        add_row("üåê Á´ØÂè£Âè∑Ôºö", self.srk_port)
        add_row("üî¢ ÁôªÂΩïÁ†ÅÔºö", self.srk_code)

        # ‰øùÂ≠òÊåâÈíÆ
        self.save_button = QPushButton("üíæ  ‰øùÂ≠òÈÖçÁΩÆ")
        self.save_button.clicked.connect(self.manual_save)
        v.addWidget(self.save_button)

        box.setLayout(v)
        outer.addWidget(box)

    # =========================
    # ÂéüÊúâÔºöÊìç‰ΩúÈ°µÈù¢Âå∫Ôºà‰øùÊåÅ‰∏çÂèòÔºâ
    # host ÊòØ‰∏Ä‰∏™Á©∫ QWidgetÔºåËøôÈáåÂÜÖÈÉ® setLayout
    # =========================
    def setup_ops_panel(self, host):
        outer = QVBoxLayout(host)
        outer.setContentsMargins(12, 8, 12, 8)

        box = QGroupBox("Ê¨¢Ëøé‰ΩøÁî®")
        v = QVBoxLayout()
        v.setSpacing(10)
        v.setContentsMargins(12, 10, 12, 10)

        self.file_button = QPushButton("üìÑ ÂØºÂÖ•Ê∏∏ÊàèidÔºàtxtÔºâ")
        self.file_button.clicked.connect(self.select_file)
        v.addWidget(self.file_button)

        self.thread_count_input = QLineEdit(self)
        self.thread_count_input.setPlaceholderText("Â§öÂºÄÊï∞Èáè ÔºàÊúÄ‰Ωé1Âè∞ ÊúÄÈ´òÈôêÂà∂100Âè∞Ôºâ")
        v.addWidget(self.thread_count_input)

        self.start_button = QPushButton("üöÄ ÂºÄÂßãÊü•ËØ¢")
        self.start_button.clicked.connect(self.start_processing)
        v.addWidget(self.start_button)

        self.export_button = QPushButton("üì§ ÂØºÂá∫Êï∞ÊçÆ")
        self.export_button.clicked.connect(self.export_data)
        v.addWidget(self.export_button)

        box.setLayout(v)
        outer.addWidget(box)
        self.setStyleSheet("""
            QWidget { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }  /* ËÆæÁΩÆÂÖ®Â±ÄÂ≠ó‰Ωì */

            QLineEdit {
                height: 18px;  /* ËæìÂÖ•Ê°ÜÈ´òÂ∫¶ */
                font-size: 14px;  /* ËæìÂÖ•Ê°ÜÂ≠ó‰ΩìÂ§ßÂ∞è */
                padding: 4px 8px;  /* ËæìÂÖ•Ê°ÜÂÜÖËæπË∑ù */
                border: 1.5px solid #cccccc;  /* ËæìÂÖ•Ê°ÜËæπÊ°ÜÈ¢úËâ≤ÂíåÂÆΩÂ∫¶ */
                border-radius: 6px;  /* ËæìÂÖ•Ê°ÜÂúÜËßí */
                background-color: #ffffff;  /* ËæìÂÖ•Ê°ÜËÉåÊôØËâ≤ */
            }

            QLineEdit:focus {
                border-color: #4a90e2;  /* ËæìÂÖ•Ê°ÜËÅöÁÑ¶Êó∂ËæπÊ°ÜÈ¢úËâ≤ */
                /* background-color: #eaf4ff;  ËæìÂÖ•Ê°ÜËÅöÁÑ¶Êó∂ËÉåÊôØËâ≤ */
            }

            QPushButton {
                background-color: white;            /* ÁôΩËâ≤ËÉåÊôØ */
                color: #3498db;                     /* ËìùËâ≤ÊñáÂ≠ó */
                border: 1px solid #3498db;          /* ËìùËâ≤ËæπÊ°Ü */
                border-radius: 8px;                 /* ÂúÜËßíÂçäÂæÑ8px */
                padding: 10px 16px;                 /* ÂÜÖËæπË∑ù */
                font-size: 12px;                    /* Â≠ó‰ΩìÂ§ßÂ∞è */
                font-weight: bold;                 /* Â≠ó‰ΩìÂä†Á≤ó */
                letter-spacing: 0.5px;              /* Â≠óÁ¨¶Èó¥Ë∑ù */
            }

            QPushButton:hover {
                background-color: #ecf5fb;          /* Èº†Ê†áÊÇ¨ÂÅúÊó∂ÊµÖËìùËÉåÊôØÔºàËßÜËßâÂèçÈ¶àÔºâ */
                color: #2980b9;                     /* ÊÇ¨ÂÅúÊó∂ÊñáÂ≠óÈ¢úËâ≤Á®çÂæÆÂä†Ê∑± */
                border: 1px solid #2980b9;          /* ËæπÊ°ÜÈ¢úËâ≤‰πüÁ®çÂæÆÂä†Ê∑± */
            }

            QPushButton:pressed {
                background-color: #d6eaf8;          /* Êåâ‰∏ãÊó∂Êõ¥Ê∑±‰∏ÄÁÇπÁöÑÊµÖËìùËÉåÊôØ */
                padding-left: 14px;                 /* Ê®°ÊãüÊåâÂéãÊÑü */
                padding-top: 12px;
            }

            QPushButton:disabled {
                background-color: #eee;  /* Á¶ÅÁî®ÊåâÈíÆËÉåÊôØËâ≤ */
                border: 1px solid #aaa;  /* Á¶ÅÁî®ÊåâÈíÆËæπÊ°Ü */
                color: #999;  /* Á¶ÅÁî®ÊåâÈíÆÊñáÂ≠óÈ¢úËâ≤ */
            }

            QGroupBox {
                border: 1px solid #aaa;  /* ÁªÑÊ°ÜËæπÊ°ÜÈ¢úËâ≤ÂíåÂÆΩÂ∫¶ */
                border-radius: 8px;  /* ÁªÑÊ°ÜÂúÜËßí */
                margin-top: 10px;  /* ÁªÑÊ°ÜÈ°∂ÈÉ®Â§ñËæπË∑ù */
            }

            QGroupBox::title {
                subcontrol-origin: margin;  /* ÁªÑÊ°ÜÊ†áÈ¢òÂü∫‰∫éËæπË∑ùÂÆö‰Ωç */
                subcontrol-position: top center;  /* ÁªÑÊ°ÜÊ†áÈ¢òÂ±Ö‰∏≠ */
                padding: 0 6px;  /* ÁªÑÊ°ÜÊ†áÈ¢òÂÜÖËæπË∑ù */
                font-size: 15px;  /* ÁªÑÊ°ÜÊ†áÈ¢òÂ≠ó‰ΩìÂ§ßÂ∞è */
                font-weight: bold;  /* ÁªÑÊ°ÜÊ†áÈ¢òÂä†Á≤ó */
            }

            QMessageBox { 
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;  /* ÂºπÁ™óÂ≠ó‰Ωì */
                font-size: 13px;  /* ÂºπÁ™óÂ≠ó‰ΩìÂ§ßÂ∞è */
            }
        """)

    def select_file(self):
        desktop_path = QStandardPaths.writableLocation(QStandardPaths.DesktopLocation)  # Ëé∑ÂèñÊ°åÈù¢Ë∑ØÂæÑ
        file_name, _ = QFileDialog.getOpenFileName(self, "ÈÄâÊã©Áî®Êà∑IDÊñá‰ª∂", desktop_path,
                                                   "Text Files (*.txt);;All Files (*)")
        if file_name:
            with open(file_name, 'r') as file:
                self.user_ids = [line.strip() for line in file if line.strip()]
            QMessageBox.information(self, "ÊèêÁ§∫", f"Â∑≤Âä†ËΩΩ {len(self.user_ids)} ‰∏™Áî®Êà∑IDÔºÅ")

    def start_processing(self):
        self.completed_tasks = []
        port = self.srk_port.text()
        code = self.srk_code.text()
        token = self.srk_token.text()

        if not port or not code or not token:
            QMessageBox.warning(self, "ËæìÂÖ•ÈîôËØØ", "ËØ∑Á°Æ‰øùÊâÄÊúâËæìÂÖ•Ê°ÜÈÉΩÂ∑≤Â°´ÂÜôÔºÅ")
            return

        # Ëé∑ÂèñÁî®Êà∑ËæìÂÖ•ÁöÑÁ∫øÁ®ãÊï∞Èáè
        thread_count = self.thread_count_input.text()
        if thread_count.isdigit() and int(thread_count) > 0:
            max_threads = min(int(thread_count), 150)  # ÈôêÂà∂Á∫øÁ®ãÊï∞ÈáèÊúÄÈ´ò‰∏∫200
            self.thread_pool.setMaxThreadCount(max_threads)
        else:
            QMessageBox.warning(self, "ËæìÂÖ•ÈîôËØØ", "ËØ∑Á°Æ‰øùÂ§öÂºÄÊï∞Èáè‰∏∫Ê≠£Êï¥Êï∞ÔºÅ")
            return

        self.file_button.setEnabled(False)
        self.start_button.setEnabled(False)
        self.export_button.setEnabled(False)
        self.srk_port.setEnabled(False)
        self.srk_token.setEnabled(False)
        self.srk_code.setEnabled(False)
        self.save_button.setEnabled(False)

        for user_id in self.user_ids:
            signals = WorkerSignals()
            signals.finished.connect(self.task_finished)
            worker = DataWorker(user_id, signals, port, code, token)
            self.thread_pool.start(worker)

    def task_finished(self, result):
        self.completed_tasks.append(result)
        if len(self.completed_tasks) == len(self.user_ids):
            QMessageBox.information(self, "ÊèêÁ§∫", "ÊâÄÊúâÊï∞ÊçÆÂ∑≤Ëé∑ÂèñÂÆåÊàêÔºÅ")
            self.file_button.setEnabled(True)
            self.start_button.setEnabled(True)
            self.export_button.setEnabled(True)
            self.srk_port.setEnabled(True)
            self.srk_token.setEnabled(True)
            self.srk_code.setEnabled(True)
            self.save_button.setEnabled(True)

    def export_data(self):
        if not self.completed_tasks:
            QMessageBox.warning(self, "Ë≠¶Âëä", "Ê≤°ÊúâÊï∞ÊçÆÂèØÂØºÂá∫ÔºÅ")
            return

        try:
            wb = Workbook()
            ws = wb.active
            ws.append(['APPID', '‰ΩôÈ¢ù', 'ÈíªÁü≥', 'ÂÜªÁªìÁä∂ÊÄÅ', 'Ê¥ªÂä®Áä∂ÊÄÅ'])  # Êõ¥Êñ∞Ë°®Â§¥

            for task in self.completed_tasks:
                parts = task.split(", ")
                # ‰ΩøÁî®ÈªòËÆ§ÂÄºÂ§ÑÁêÜÂèØËÉΩÁº∫Â§±ÁöÑÊï∞ÊçÆ
                Ê∏∏Êàèid = self.convert_to_number(parts[0]) if len(parts) > 0 else "Êó†Êï∞ÊçÆ"
                appid = self.convert_to_number(parts[1]) if len(parts) > 1 else "Êó†Êï∞ÊçÆ"
                valid_bet = self.convert_to_number(parts[2]) if len(parts) > 2 else "Êó†Êï∞ÊçÆ"
                other_info = self.convert_to_number(parts[3]) if len(parts) > 3 else "Êó†Êï∞ÊçÆ"
                reg_ip = parts[4] if len(parts) > 4 else "Êó†Êï∞ÊçÆ"
                hd = parts[5] if len(parts) > 5 else "Êó†Êï∞ÊçÆ"

                # Êõ¥Êñ∞Êï∞ÊçÆË°å
                ws.append(
                    [appid, valid_bet, other_info, reg_ip, hd])

            current_time = datetime.now().strftime("%mÊúà%dÊó•%HÊó∂%MÂàÜ%SÁßí")
            filename = f"Ë¥¶Âè∑Áä∂ÊÄÅ_{current_time}.xlsx"
            wb.save(filename)
            QMessageBox.information(self, "ÊèêÁ§∫", f"Êï∞ÊçÆÂ∑≤ÂØºÂá∫Âà∞ {filename}")
            os.startfile(filename)

        except Exception as e:
            QMessageBox.critical(self, "ÂØºÂá∫ÈîôËØØ", f"ÂØºÂá∫Êï∞ÊçÆÊó∂ÂèëÁîüÈîôËØØ: {str(e)}")

    def convert_to_number(self, value):
        try:
            return float(value)  # Â∞ùËØïÂ∞ÜÂÄºËΩ¨Êç¢‰∏∫ÊµÆÁÇπÊï∞
        except ValueError:
            return "Êó†Êï∞ÊçÆ"  # ËΩ¨Êç¢Â§±Ë¥•Êó∂ËøîÂõû"Êó†Êï∞ÊçÆ"

    def save_config(self, port, token, code):  # ‰øùÂ≠òÈÖçÁΩÆÂà∞Êñá‰ª∂
        config = ConfigParser()
        config['USER'] = {'Port': port,  'Token': token, 'Code': code}
        with open('config.ini', 'w') as configfile:
            config.write(configfile)

    def load_config(self):  # ‰ªéÊñá‰ª∂Âä†ËΩΩÈÖçÁΩÆ
        config = ConfigParser()
        config.read('config.ini')
        if 'USER' in config:
            self.srk_port.setText(config['USER']['port'])
            self.srk_token.setText(config['USER']['Token'])
            self.srk_code.setText(config['USER']['Code'])

    def manual_save(self):  # ÊâãÂä®‰øùÂ≠òÂáΩÊï∞  port
        port = self.srk_port.text()
        token = self.srk_token.text()
        code = self.srk_code.text()
        if port and token and code:
            self.save_config(port, token, code)
            QMessageBox.information(self, "ÊèêÁ§∫", "‚úÖ ÈÖçÁΩÆÂ∑≤‰øùÂ≠òÔºÅ")
        else:
            QMessageBox.warning(self, "Ë≠¶Âëä", "ËØ∑Â°´ÂÜôÂÆåÊï¥ÁöÑÈÖçÁΩÆÔºÅ")


if __name__ == "__main__":
    app = QApplication(sys.argv)
    window = UserWindow()
    window.show()
    sys.exit(app.exec_())
